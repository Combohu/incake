"use strict";require(["config"],function(){require(["jquery","tools","header","footer","template","cookie"],function(p,t,m,e,i,n){new Promise(function(t,e){p("header").load("/html/component/header.html",function(){t()}),p("footer").load("/html/component/footer.html")}).then(function(){m.nav(),m.localCity(),m.login(),m.exit(),m.num()});p("#list_active");var f=p("#money"),d=0,c=t.$(".empty_basket")[0];if(p.cookie("cart")){var r=p.cookie("cart"),a=JSON.parse(r),o=i("pro_template",{cookies:a});p("#list_active").html(o),t.$(".item").length?c.style.display="none":c.style.display="block";var l=!0,h=!1,s=void 0;try{for(var v,u=a[Symbol.iterator]();!(l=(v=u.next()).done);l=!0){var k=v.value;d+=k.price*k.num}}catch(t){h=!0,s=t}finally{try{l||null==u.return||u.return()}finally{if(h)throw s}}f.html(d);p(".btn_sub"),p(".btn_add");p("#list_active").on("click",".btn_sub",function(t){var e=p.cookie("cart"),i=JSON.parse(e),n=p(this).siblings().children(":first"),c=n.parents(".c_amount").siblings(".c_product").find(".cn"),r=n.parents(".c_amount").siblings(".c_cheaper").find(".xiaoJi"),a=n.val();if(1<a){a--;for(var o=0;o<i.length;o++)if(i[o].name==c.html()){i[o].num=a,r.html(i[o].price*i[o].num),n.val(i[o].num);break}var l=JSON.stringify(i);p.cookie("cart",l,{path:"/"});var h=p("#list_active").find(".item"),s=p("#list_active").find(".btn_ckBox");for(o=d=0;o<h.length;o++)s.eq(o).prop("checked")&&(d+=parseInt(s.eq(o).parents(".item").find(".xiaoJi").html()),f.html(d))}m.num()}),p("#list_active").on("click",".btn_add",function(t){var e=p.cookie("cart"),i=JSON.parse(e),n=p(this).siblings().children(":first"),c=n.parents(".c_amount").siblings(".c_product").find(".cn"),r=n.parents(".c_amount").siblings(".c_cheaper").find(".xiaoJi"),a=n.val();a++;for(var o=0;o<i.length;o++)if(i[o].name==c.html()){i[o].num=a,r.html(i[o].price*i[o].num),n.val(i[o].num);break}var l=JSON.stringify(i);p.cookie("cart",l,{path:"/"});var h=p("#list_active").find(".item"),s=p("#list_active").find(".btn_ckBox");for(o=d=0;o<h.length;o++)s.eq(o).prop("checked")&&(d+=parseInt(s.eq(o).parents(".item").find(".xiaoJi").html()),f.html(d));m.num()});p("#list_active").find(".item");var _=p("#list_active").find(".btn_ckBox");p("#list_active").on("change",".btn_ckBox",function(t){for(var e=d=0;e<_.length;e++)_.eq(e).prop("checked")?d+=parseInt(_.eq(e).parents(".item").find(".xiaoJi").html()):d+=0,f.html(d)}),p(".list_footer").on("change",".text_checkALL",function(){if(p(this).prop("checked"))for(var t=d=0;t<_.length;t++)d+=parseInt(_.eq(t).parents(".item").find(".xiaoJi").html()),f.html(d);else d=0,f.html(d)}),p("#list_active").on("click",".btn_del",function(t){for(var e=p(".text_checkALL"),i=p.cookie("cart"),n=JSON.parse(i),c=p(this).parents(".item"),r=c.find(".cn").html(),a=0;a<n.length;a++)if(n[a].name==r){n.splice(a,1);break}var o=JSON.stringify(n);p.cookie("cart",o,{path:"/",expires:3}),c.remove(),m.num(),p("#item").length<=0&&(e.prop("checked",!1),p("#money").text(0))});var g=p(".text_checkALL"),b=p("#list_active").find(".btn_ckBox"),x=b.length;g.change(function(){g.prop("checked")?b.prop("checked",!0):(x=0,b.prop("checked",!1))});for(var y=0;y<b.length;y++)b.eq(y).change(function(){g.prop("checked",!0)&&(p(this).prop("checked")?x++:x--,x===b.length?g.prop("checked",!0):g.prop("checked",!1))})}})});