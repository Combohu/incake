"use strict";require(["config"],function(){require(["jquery","tools","header","footer","template","fly"],function(b,v,I,i,k){new Promise(function(i,e){b("header").load("/html/component/header.html",function(){i()}),b("footer").load("/html/component/footer.html")}).then(function(){I.nav(),I.localCity(),I.login(),I.exit(),I.num()});var e=location.search.slice(1).split("="),t={};t[e[0]]=e[1],b.ajax({method:"POST",data:t,dataType:"json",url:"http://localhost/java_script/incake_project/server/api/php/detail.php",success:function(i){if(1===i.code){var e=function(i){var s=b("#preview_big"),e=b("#fangDaJing"),g=b("#len"),h=i;s.on("mouseenter",function(){g.css("display","block"),e.css("display","block")}),s.on("mousemove",function(i){var e=i.pageX,t=i.pageY,o=s.offset(),c=g.outerWidth(),l=g.outerHeight(),n=e-o.left-c/2,a=t-o.top-l/2;a<=0?a=0:250<a&&(a=250),n<=0?n=0:250<n&&(n=250),g.css("left",n),g.css("top",a),h.css("top",-2*a),h.css("left",-2*n)}),s.on("mouseleave",function(){g.css("display","none"),e.css("display","none")})},t=k("detail_template",{product:i.product});b("#baoguo").html(t),e(b("#bigImg1"));var o=b("#middleImg1"),c=b("#middleImg2"),l=b("#middleImg3"),n=b("#middleImg4"),a=b("#preview_small1"),s=b("#preview_small2"),g=b("#preview_small3"),h=b("#preview_small4");if(a.click(function(){c.hide(),l.hide(),n.hide(),o.show(),b("#bigImg2").hide(),b("#bigImg3").hide(),b("#bigImg4").hide(),b("#bigImg1").show(),e(b("#bigImg1"))}),s.click(function(){o.hide(),l.hide(),n.hide(),c.show(),b("#bigImg1").hide(),b("#bigImg3").hide(),b("#bigImg4").hide(),b("#bigImg2").show(),e(b("#bigImg2"))}),g.click(function(){o.hide(),c.hide(),n.hide(),l.show(),b("#bigImg1").hide(),b("#bigImg2").hide(),b("#bigImg4").hide(),b("#bigImg3").show(),e(b("#bigImg3"))}),h.click(function(){o.hide(),c.hide(),l.hide(),n.show(),b("#bigImg1").hide(),b("#bigImg2").hide(),b("#bigImg3").hide(),b("#bigImg4").show(),e(b("#bigImg4"))}),b.cookie("cart")&&2!==b.cookie("cart").length){var r=b.cookie("cart"),d=(t=JSON.parse(r),b("#text_amout")),m=location.search.slice(1).split("="),u={};u[m[0]]=m[1];for(var p=0;p<t.length;p++)if(t[p].id===u.id){d.val(t[p].num);break}p==t.length&&d.val(1)}else{(d=b("#text_amout")).val(1)}var f=(d=b("#text_amout")).val();b("#btn_add").click(function(){d.val(++f)});f=(d=b("#text_amout")).val();b("#btn_sub").click(function(){1<f?d.val(--f):d.val(1)}),b("#add_basket").click(function(i){var e=b("#bag").offset(),t={top:i.pageY-b(window).scrollTop(),left:i.pageX},o=b("<div></div>").css({width:20,height:20,background:"#f00"});e.top-=b(window).scrollTop(),o.fly({start:t,end:e,onEnd:function(){this.destroy()}}),b("#bg").css("display","block"),b("#btn-cancel").click(function(){b("#bg").css("display","none")});var c=location.search.slice(1).split("=");({})[c[0]]=c[1];var l=b("#middleImg1"),n=b("#introduce_tittle"),a=b("#left_content"),s=b("#spec"),g=(b("#img"),b("#newPrice")),h=[];if(v.cookie("cart")&&2!==v.cookie("cart").length){h=JSON.parse(v.cookie("cart"));for(var r=0;r<h.length;r++)if(h[r].id==c[1]){h[r].num++;break}if(r===h.length){var d={id:c[1],pictrue:l.attr("src"),name:n.html(),shuXing:a.html(),guiGe:s.html(),price:g.html(),num:1};h.push(d)}}else{d={id:c[1],pictrue:l.attr("src"),name:n.html(),shuXing:a.html(),guiGe:s.html(),price:g.html(),num:1};h.push(d)}var m=JSON.stringify(h);v.cookie("cart",m,"path=/"),I.num()})}}})})});